C51 COMPILER V9.60.7.0   MAIN                                                              12/05/2023 18:57:17 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: F:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <STC89C5xRC.H>
   2          #include <INTRINS.H>
   3          #include "Timer0.h"
   4          #include "Inde_Key.h"
   5          
   6          // void Timer0_init()
   7          // //é…ç½®å¯„å­˜å™¨
   8          // {
   9          //     //TMOD = 0x01;
  10          //     //0000 0001
  11          //     //å‰å››ä½ä¸ºå®šæ—¶å™¨1ï¼Œä¸ç®¡ï¼›ç¬¬äº”ä½ä¸ºGATEï¼Œç¬¬å…­ä½ä¸ºC/Tï¼Œä¸ƒã€å…«ä½ä¸ºM1ã€M0
  12          //     //æ­¤å¤„ä¸å¯ä½å¯»å€ï¼Œåªèƒ½æ•´ä½“èµ‹å€¼
  13          //     //è¿™æ ·å†™æœ‰é—®é¢˜ï¼šåœ¨é…ç½®Timer1çš„æ—¶å€™ä¼šæŠŠTimer2çš„è®¾ç½®æŠ¹åŽ»
  14          
  15          //     TMOD = TMOD & 0xF0;
  16          //     //æŠŠTMODçš„ç¬¬å››ä½æ¸…é›¶è€Œé«˜å››ä½ä¸å˜ï¼ˆæŒ‰ä½ä¸Žï¼šæœ‰0ä¸º0ï¼‰
  17          //     TMOD =  TMOD | 0x01;
  18          //     //TMODçš„æœ€ä½Žä½ç½®ä¸€ï¼ˆæŒ‰ä½æˆ–ï¼šæœ‰1ä¸º1ï¼‰
  19          
  20          
  21          //     //TCONå¯ä¸ºå¯»å€
  22          //     TF0 = 0;
  23          //     //æ¸…é›¶
  24          //     TR0 = 1;
  25          //     TH0 = 64613 / 256;
  26          //     TL0 = 64613 % 256;
  27          //     //çº¦921.65æ¬¡ä¸º1msï¼Œå³åˆå§‹åŒ–ä¸º65535 - 922 = 64613
  28          //     //åˆ†åˆ«å–é«˜ä½å’Œä½Žä½
  29          
  30          
  31          //     //é…ç½®ä¸­æ–­
  32          //     ET0 = 1;
  33          //     EA = 1;
  34          //     PT0 = 0;
  35          // }
  36          
  37          
  38          
  39          // void Timer0_Init(void)   //1æ¯«ç§’@11.0592MHz
  40          // {
  41          //  AUXR &= 0x7F;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
  42          //  TMOD &= 0xF0;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  43          //  TMOD |= 0x01;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  44          //  TL0 = 0x66;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  45          //  TH0 = 0xFC;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  46          //  TF0 = 0;        //æ¸…é™¤TF0æ ‡å¿—
  47          //  TR0 = 1;        //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
  48          //  ET0 = 1;        //ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­
  49          //     EA = 1;//éœ€è¦è‡ªå·±åŠ 
  50          //     PT0 = 0;//åŒä¸Š
  51          // }
  52          
  53          
  54          unsigned char KeyNum = 0;
C51 COMPILER V9.60.7.0   MAIN                                                              12/05/2023 18:57:17 PAGE 2   

  55          unsigned char LEDMode = 0;
  56          
  57          void main()
  58          {
  59   1          P2 = 0xFE;//ç‚¹äº®æœ€ä½Žä½LED
  60   1          Timer0_init();
*** WARNING C206 IN LINE 60 OF main.c: 'Timer0_init': missing function-prototype
  61   1          //åˆå§‹åŒ–å®šæ—¶å™¨ï¼Œæ­¤æ—¶å®šæ—¶å™¨å¼€å§‹è¿è¡Œ
  62   1          //å®šæ—¶å™¨çš„å·¥ä½œä¸éœ€è¦å•ç‹¬æ‰§è¡Œï¼Œåªéœ€å¯åŠ¨å³å¯
  63   1      
  64   1          while(1)
  65   1          {
  66   2              KeyNum = Inde_Key();
  67   2              if(KeyNum)
  68   2              {
  69   3                  if(KeyNum == 1)
  70   3                  {
  71   4                      LEDMode++;
  72   4                      if(LEDMode == 2)
  73   4                      {
  74   5                          LEDMode = 0;
  75   5                      }
  76   4                  }
  77   3              }
  78   2      
  79   2          }
  80   1      }
  81          
  82          
  83          void Timer0_Isr(void) interrupt 1
  84          {
  85   1          static unsigned int T0_count = 0;
  86   1          //å®šä¹‰ä¸ºé™æ€å±€éƒ¨å˜é‡ï¼Œä½¿å˜é‡åœ¨å‡½æ•°ç»“æŸåŽä»ä¿ç•™
  87   1      
  88   1        TL0 = 0x66;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  89   1          //è¿™é‡Œæ¯”è‡ªå·±è®¾ç½®çš„å¤šä¸€ä½ï¼Œå› ä¸ºè‡ªå·±ç®—å‡ºæ¥çš„64613 + 922 = 65535 ä¸ä¼šæº¢å‡ºï¼Œè¦å†
             -åŠ 1æ‰æº¢å‡º
  90   1      
  91   1        TH0 = 0xFC;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  92   1      
  93   1          T0_count++;
  94   1          if(T0_count >= 500)//é—´éš”500ms
  95   1          {
  96   2              T0_count = 0;
  97   2              if(LEDMode == 0)
  98   2              {
  99   3                  P2 = _crol_(P2, 1);
 100   3                  //å·¦ç§»ï¼Œå½“ç§»åˆ°æœ€é«˜ä½æ—¶ï¼Œå›žåˆ°ç¬¬ä¸€ä½ï¼Œæ˜¯ä¸€ä¸ªå¾ªçŽ¯è¿‡ç¨‹
 101   3                  //å±žäºŽINTRINS.H
 102   3              }
 103   2              if(LEDMode == 1)
 104   2              {
 105   3                  P2 = _cror_(P2, 1);
 106   3                  //å³ç§»
 107   3              }
 108   2      
 109   2          }
 110   1      }
 111          
 112          
 113          // //å½“äº§ç”Ÿä¸­æ–­æ—¶ï¼Œä¼šè·³è½¬åˆ°æ­¤å‡½æ•°æ‰§è¡Œï¼Œæ‰§è¡Œå®ŒåŽå†å›žåˆ°åŽŸå‡½æ•°
 114          
C51 COMPILER V9.60.7.0   MAIN                                                              12/05/2023 18:57:17 PAGE 3   

 115          // //è®¡ç®—ä¸­æ–­æ¬¡æ•°
 116          // void Timer0_Routime() interrupt 1
 117          // {
 118          //     TH0 = 64613 / 256;
 119          //     TL0 = 64613 % 256;
 120          //     //ä¸¥æ ¼æ¥è®²è¿™é‡Œéœ€è¦å†+1ï¼Œå¦åˆ™ä¼šå¤šç®—1ms
 121          //     //é‡ç½®è®¡æ•°å™¨
 122          //     T0_count++;
 123          //     if(T0_count >= 1000)
 124          //     //1000æ¬¡ä¸­æ–­ä¸º1s
 125          //     {
 126          //         T0_count = 0;
 127          //         P20 = ~P20;
 128          //     }
 129          // }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    114    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
